/* **************CREATED BY MISSION SHRESTHA, 2024/06/21 ****************** */

-- COMPANY
create or replace TABLE DW_DWH.DWH_D_ORG_COMPANY_LU (
COMPANY_KEY NUMBER NOT NULL,
COMPANY_ID VARCHAR NOT NULL,
COMPANY_DESC VARCHAR,
RCD_INS_TS TIMESTAMP_LTZ(9) NOT NULL,
RCD_UPD_TS TIMESTAMP_LTZ(9) NOT NULL,
RCD_CLOSE_FLG NUMBER NOT NULL,
RCD_CLOSE_DT DATE NOT NULL,


RMS_CO_ADD1 VARCHAR NOT NULL,
RMS_CO_ADD2 VARCHAR ,
RMS_CO_ADD3 VARCHAR ,
RMS_CO_CITY VARCHAR NOT NULL,
RMS_CO_STATE VARCHAR ,
RMS_CO_COUNTRY VARCHAR NOT NULL,
RMS_CO_POST VARCHAR ,
constraint DWH_D_ORG_COMPANY_LU_PK1 primary key (COMPANY_ID)
);


-- CHAIN/BRAND
CREATE
OR REPLACE TABLE DW_DWH.DWH_D_ORG_CHN_LU (
CHN_KEY NUMBER NOT NULL,
CHN_ID VARCHAR NOT NULL,
CHN_DESC VARCHAR,
COMPANY_ID VARCHAR NOT NULL,
COMPANY_KEY VARCHAR NOT NULL,
COMPANY_DESC VARCHAR,
RCD_INS_TS TIMESTAMP_LTZ(9) NOT NULL,
RCD_UPD_TS TIMESTAMP_LTZ(9) NOT NULL,
RCD_CLOSE_FLG NUMBER NOT NULL,
RCD_CLOSE_DT DATE NOT NULL,

RMS_BRND_DNUM VARCHAR,
RMS_BRND_SDESC VARCHAR,
RMS_SRC_ID VARCHAR,
RMS_LOAD_DATE DATE, 
CONSTRAINT DWH_D_ORG_CHN_LU_PK1 PRIMARY KEY (CHN_ID)
);


CREATE
OR REPLACE TABLE DW_DWH.DWH_D_ORG_ARA_LU (
    ARA_KEY NUMBER NOT NULL,
    ARA_ID VARCHAR,
    ARA_DESC VARCHAR,
    CHN_KEY NUMBER NOT NULL,
    CHN_ID VARCHAR,
    CHN_DESC VARCHAR,
    COMPANY_KEY NUMBER NOT NULL,
    COMPANY_ID VARCHAR,
    COMPANY_DESC VARCHAR,
    RCD_INS_TS TIMESTAMP_LTZ NOT NULL,
    RCD_UPD_TS TIMESTAMP_LTZ NOT NULL,
    RCD_CLOSE_FLG NUMBER NOT NULL,
    RCD_CLOSE_DT DATE NOT NULL,
    -- 
    RMS_Q_CPY_DNUM VARCHAR,
    RMS_Q_CPY_SDESC VARCHAR,
    RMS_SRC_ID VARCHAR,
    RMS_LOAD_DATE DATE,

    CONSTRAINT DWH_D_ORG_ARA_LU_PK1 PRIMARY KEY (ARA_KEY)
);


CREATE
	OR REPLACE TABLE DW_DWH.DWH_D_ORG_RGN_LU (
	RGN_KEY NUMBER NOT NULL
	,RGN_ID VARCHAR
	,RGN_DESC VARCHAR
	,ARA_KEY NUMBER NOT NULL
	,ARA_ID VARCHAR
	,ARA_DESC VARCHAR
	,CHN_KEY NUMBER NOT NULL
	,CHN_ID VARCHAR
	,CHN_DESC VARCHAR
	,COMPANY_KEY NUMBER
	,COMPANY_ID VARCHAR
	,COMPANY_DESC VARCHAR
	
	,RCD_INS_TS TIMESTAMP_LTZ NOT NULL
	,RCD_UPD_TS TIMESTAMP_LTZ NOT NULL
	,RCD_CLOSE_FLG NUMBER NOT NULL
	,RCD_CLOSE_DT DATE NOT NULL

    -- 
    ,RMS_Q_RGN_DNUM VARCHAR
	,RMS_Q_RGN_SDESC VARCHAR
	,RMS_SRC_ID VARCHAR
	,RMS_LOAD_DATE DATE
	,CONSTRAINT DWH_D_ORG_RGN_LU_PK1 PRIMARY KEY (RGN_KEY)
	);